/*! For license information please see main.fd373a9022154eb88b26.js.LICENSE.txt */
(()=>{"use strict";class e{constructor(e,t="div",n=[],i=""){this.element=document.createElement(t),this.element.classList.add(...n),this.element.textContent=i,e&&e.append(this.element)}initRouter(){""===window.location.hash&&(window.location.hash="#/")}destroy(){this.element.remove()}}class t extends e{constructor(t){super(t,"div",["main__games"]),this.linkToFirstGame=new e(this.element,"a",["main__game"],"Аудиовызов"),this.linkToSecondGame=new e(this.element,"a",["main__game"],"Спринт"),this.linkToFirstGame.element.setAttribute("href","#audio-challenge"),this.linkToSecondGame.element.setAttribute("href","#sprint")}}class n extends e{constructor(t){super(t,"div",["main__footer","footer"]),this.info=new e(this.element,"div",["footer__info"]),this.linkToSchool=new e(this.info.element,"a",["school"],""),this.linkToSchool.element.setAttribute("href","https://rs.school/"),new e(this.linkToSchool.element,"img",["rs-img"]).element.setAttribute("src","https://rs.school/images/rs_school_js.svg"),new e(this.info.element,"span",["year"]).element.innerHTML="2022",this.git=new e(this.info.element,"div",["footer__git"]);const n=new e(this.git.element,"a",["footer__git--user"],"");n.element.innerHTML+='\n    <svg aria-hidden="true" style="height: 20px;" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512">\n      <path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path>\n    </svg>\n    <div>Пaша</div>',n.element.setAttribute("href","https://github.com/fraterpavlo/")}}class i extends e{constructor(e,t,n=[],i){super(e,"input",["ui-input"]),this.getInputValue=()=>{},this.element.setAttribute("type",t),this.element.classList.add(...n),i&&this.element.setAttribute("value",i),this.element.addEventListener("input",(e=>this.getInputValue(e)))}}class s extends e{constructor(e,t=[],n,i=!1){super(e,"button",["btn"],n),this.onClickButton=()=>{},this.element.classList.add(...t),this.element.addEventListener("click",(()=>this.onClickButton())),i&&this.setDisabled(!0)}setDisabled(e=!1){this.element.toggleAttribute("disabled",e)}removeDisabled(){this.element.removeAttribute("disabled")}}var o=function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{d(i.next(e))}catch(e){o(e)}}function a(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}d((i=i.apply(e,t||[])).next())}))};const r="https://rs-lang-rss-task.herokuapp.com";var a=function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{d(i.next(e))}catch(e){o(e)}}function a(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}d((i=i.apply(e,t||[])).next())}))};class d extends e{constructor(t){super(t,"div",["auth"]),this.state={name:"",email:"",password:""},this.element.setAttribute("id","auth"),this.linkToClose=new e(this.element,"a",["close"],"X"),this.linkToClose.element.setAttribute("href","#");const n=new e(this.element,"div",["auth__window"]),d=new e(n.element,"div",["auth__inp"]);this.labelName=new e(d.element,"label",["labelName"],"Имя:"),this.labelName.element.setAttribute("for","inputName"),this.inputName=new i(d.element,"text",["inputName"]),this.inputName.element.setAttribute("id","inputName"),this.inputName.getInputValue=e=>this.updateState("name",e);const c=new e(n.element,"div",["auth__inp"]);this.labelEmail=new e(c.element,"label",["labelEmail"],"Email:"),this.labelEmail.element.setAttribute("for","inputIdemail"),this.inputEmail=new i(c.element,"text",["inputEmail"]),this.inputEmail.element.setAttribute("id","inputIdemail"),this.inputEmail.getInputValue=e=>this.updateState("email",e);const l=new e(n.element,"div",["auth__inp"]);this.labelPass=new e(l.element,"label",["labelEmail"],"Пароль:"),this.labelPass.element.setAttribute("for","inputIdemail"),this.inputPass=new i(l.element,"password",["inputEmail"]),this.inputPass.element.setAttribute("id","inputIdemail"),this.inputPass.getInputValue=e=>this.updateState("password",e);const u=new e(n.element,"div",["auth__btns"]);this.signin=new s(u.element,["auth__signin"],"Войти"),this.signup=new s(u.element,["auth__signup"],"Регистрация"),this.logout=new s(u.element,["auth__logout"],"Выйти"),this.signin.onClickButton=()=>a(this,void 0,void 0,(function*(){var e;yield(e={email:this.state.email,password:this.state.password},o(void 0,void 0,void 0,(function*(){try{const t=yield fetch(`${r}/signin`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){const e=yield t.json();localStorage.user=JSON.stringify(e)}}catch(e){throw new Error("")}})))})),this.signup.onClickButton=()=>a(this,void 0,void 0,(function*(){var e;yield(e=this.state,o(void 0,void 0,void 0,(function*(){try{yield fetch(`${r}/users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(e){throw new Error("")}})))})),this.logout.onClickButton=()=>a(this,void 0,void 0,(function*(){const e=JSON.parse(localStorage.user).userId;yield(e=>o(void 0,void 0,void 0,(function*(){try{yield fetch(`${r}/users/${e}`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}}),console.log("Пользователь удалён."),localStorage.clear()}catch(e){throw new Error("")}})))(e)}))}updateState(e,t){const n=t.target;this.state[e]=n.value}}class c extends e{constructor(t){super(t,"div",["main__navigation","navigation"]),this.points=new e(this.element,"div",["main__points","points"]),this.linkToRegister=new e(this.points.element,"a",["points__register"],"Регистрация"),this.linkToTextbook=new e(this.points.element,"a",["points__textbook"],"Учебник"),this.linkToAboutInfo=new e(this.points.element,"a",["points__about"],"О нас"),this.linkToRegister.element.setAttribute("href","#auth"),this.linkToTextbook.element.setAttribute("href","#textbook"),this.linkToAboutInfo.element.setAttribute("href","#about")}}class l extends e{constructor(t){super(t,"div",["main__title"]),this.about=new e(this.element,"div",["main__about"]),this.title=new e(this.about.element,"h1",["main__title"]),this.subtitle=new e(this.about.element,"h3",["main__subtitle"]),this.title.element.innerHTML="RSLang",this.subtitle.element.innerHTML="Start learning English with RS Lang today!"}}class u extends e{constructor(i){super(i,"div",["main__container"]),new l(this.element),new t(this.element),new d(this.element),this.container=new e(this.element,"div",["main__cont"]),new c(this.container.element),new n(this.container.element)}}class h{constructor(e=null,t="div",n=[],i=""){const s=document.createElement(t);s.classList.add(...n),s.textContent=i,e&&e.append(s),this.node=s}destroy(){this.node.remove()}}function m(e,t){let n=e+Math.random()*(t+1-e);return Math.floor(n)}class w extends h{constructor(e,t="div",n,i={hide:"hide",show:"show"},s=""){super(e,t,n,s),this.animatingClasses=i,this.node.classList.add(i.show),this.animateIn()}animateIn(){return new Promise((e=>{requestAnimationFrame((()=>requestAnimationFrame((()=>{this.node.classList.contains(this.animatingClasses.show)||e(),this.node.classList.remove(this.animatingClasses.show),this.node.ontransitionend=t=>{t.target===this.node&&(this.node.ontransitionend=null,e())}}))))}))}animateOut(){return new Promise((e=>{requestAnimationFrame((()=>requestAnimationFrame((()=>{this.node.classList.contains(this.animatingClasses.hide)&&e(),this.node.classList.add(this.animatingClasses.hide),this.node.ontransitionend=t=>{t.target===this.node&&(this.node.ontransitionend=null,e(),this.node.classList.remove(this.animatingClasses.hide))}}))))}))}destroy(){const e=Object.create(null,{destroy:{get:()=>super.destroy}});return t=this,n=void 0,s=function*(){yield this.animateOut(),e.destroy.call(this)},new((i=void 0)||(i=Promise))((function(e,o){function r(e){try{d(s.next(e))}catch(e){o(e)}}function a(e){try{d(s.throw(e))}catch(e){o(e)}}function d(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(r,a)}d((s=s.apply(t,n||[])).next())}));var t,n,i,s}}class p extends w{constructor(e,t="div",n,i={hide:"hide",show:"show"},s=""){super(e,t,n,i,s)}toggleFullScreen(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}}class v extends p{constructor(e,t,n={hide:"hide",show:"show"}){super(e,"div",["categories-page","categories-page__container"],n);const i=new h(this.node,"div",["categories-page__head-panel"]);new h(i.node,"button",["common-btn","categories-page__back-btn"]).node.addEventListener("click",(()=>{this.onHome()}),{once:!0}),new h(i.node,"button",["common-btn","categories-page__fullscreen-btn"]).node.addEventListener("click",this.toggleFullScreen);const s=new h(this.node,"div",["categories-page__main-field","main-field"]);new h(s.node,"h1",["game-name-title","main-field__game-name-title"],"Аудиовызов"),new h(s.node,"div",["main-field__game-description-wrap","game-description"]).node.innerHTML='\n      <p class="game-description__description">\n        «Аудиовызов» - это игра, которая улучшает восприятие речи на слух.\n        Каждый раунд вам нужно правильно перести слово, которое будет озвучена на английском. Слова разделены на\n        категории по возрастанию сложности. Выберите категорию.\n      </p>\n      <ul class="game-description__instructions-list instructions-list">\n        <li class="instructions-list__item">\n          Используйте мышь, чтобы выбрать.\n        </li>\n        <li class="instructions-list__item">\n          Используйте цифровые клавиши от 1 до 5 для выбора ответа\n        </li>\n        <li class="instructions-list__item">\n          Используйте пробел для повтроного звучания слова\n        </li>\n        <li class="instructions-list__item">\n          Используйте клавишу Enter для подсказки или для перехода к следующему слову\n        </li>\n      </ul>\n    ';const o=new h(s.node,"div",["main-field__categories-wrap","categories"]);for(let e=0;e<t.levelAmount;e++)new h(o.node,"button",["common-btn","categories__button"],`Level ${e+1}`).node.addEventListener("click",(()=>{this.onSelect(e)}))}}class g extends h{constructor(e,t="div",n=[]){super(e,t,n)}start(e){this.initialTime=e,this.timerId&&this.stop();let t=e;const n=e=>{this.node.textContent=`${e}`};n(e),this.timerId=window.setInterval((()=>{t--,n(t),t<=0&&(this.onTimeout(),this.stop())}),1e3)}stop(){window.clearInterval(this.timerId)}}var _=function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{d(i.next(e))}catch(e){o(e)}}function a(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}d((i=i.apply(e,t||[])).next())}))};const b=new class{constructor(){this.localSoundsBaseURL="../../assets/audio",this.cache=new Map,this.localSoundsNamesList=["applause","success","fail"],this.currentAudio=null}preload(){return _(this,void 0,void 0,(function*(){Promise.all(this.localSoundsNamesList.map((e=>this.loadFile(`${this.localSoundsBaseURL}/${e}.mp3`))))}))}loadFile(e){return _(this,void 0,void 0,(function*(){const t=yield fetch(e),n=yield t.blob();return this.cache.set(e,n),n}))}playSound(e){const t=this.cache.get(e);let n;return t?n=new Audio(URL.createObjectURL(t)):(n=new Audio(e),this.loadFile(e)),n.addEventListener("ended",(()=>{this.currentAudio=null}),{once:!0}),this.currentAudio?this.currentAudio.addEventListener("ended",(()=>{this.currentAudio=n,n.play()}),{once:!0}):(this.currentAudio=n,n.play()),n}};var f;!function(e){e.applause="../../assets/audio/applause.mp3",e.success="../../assets/audio/success.mp3",e.fail="../../assets/audio/fail.mp3"}(f||(f={}));var y=function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{d(i.next(e))}catch(e){o(e)}}function a(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}d((i=i.apply(e,t||[])).next())}))};const A="https://rs-lang-rss-task.herokuapp.com",x=`${A}/words`;class k{constructor(){}getWords(e,t){return y(this,void 0,void 0,(function*(){const n=yield fetch(`${x}?page=${t}&group=${e}`);return yield n.json()}))}getSpecifiedWord(e,t){return y(this,void 0,void 0,(function*(){const n=yield fetch(`${x}?page=${e}&group=${t}`);return yield n.json()}))}}class L extends w{constructor(e,t,n={hide:"hide",show:"show"}){super(e,"div",["question-view__correct-answer-wrap","correct-answer-view"],n);const i=new h(this.node,"div",["correct-answer-view__image-wrap"]);this.answerImage=new h(i.node,"img",["correct-answer-view__image"]),this.answerImage.node.src=`${A}/${t.image}`;const s=new h(this.node,"div",["correct-answer-view__text-content-wrap"]),o=new h(s.node,"div",["correct-answer-view__word-info-wrap","word-info"]);this.audioWord=new h(o.node,"button",["word-info__audio-btn"]),this.audioWord.node.onclick=()=>{b.playSound(`${A}/${t.audio}`)},this.textWord=new h(o.node,"span",["word-info__text-word"],`${t.word}`),this.transcriptionWord=new h(o.node,"span",["word-info__transcription-word"],`${t.transcription}`);const r=new h(s.node,"div",["correct-answer-view__example-info-wrap","example-info"]),a=new h(r.node,"div",["example-info__text-example-wrap"]);this.audioExample=new h(a.node,"button",["example-info__text-example-audio-btn"]),this.audioExample.node.onclick=()=>{b.playSound(`${A}/${t.audioExample}`)},this.textExample=new h(a.node,"span",["example-info__text-example"]),this.textExample.node.innerHTML=t.textExample,this.textExampleTranslate=new h(r.node,"span",["example-info__text-example-translate"]),this.textExampleTranslate.node.innerHTML=t.textExampleTranslate}}class E extends w{constructor(e,t,n={hide:"hide",show:"show"}){super(e,"div",["main-field__question-container","question-view"],n),this.questionAudio=b.playSound(`${A}/${t.audio}`),this.questionDataWrapper=new h(this.node,"div",["question-view__question-data-wrapper","question-data"]),this.questionAudioBtn=new h(this.questionDataWrapper.node,"button",["question-data__question-audio-btn"]),this.questionAudioBtn.node.addEventListener("click",this.onQuestionAudioBtnListener.bind(this,t.audio));const i=new h(this.node,"div",["question-view__answers-buttons-wrap"]);this.answersBtnArr=t.answers.map((e=>new h(i.node,"button",["common-btn","question-view__answer-btn"],e.toString())))}onQuestionAudioBtnListener(e){b.playSound(`${A}/${e}`)}}var C,S=function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{d(i.next(e))}catch(e){o(e)}}function a(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}d((i=i.apply(e,t||[])).next())}))};class T extends p{constructor(e,t,n,i={hide:"hide",show:"show"}){super(e,"div",["game-page","game-page__container"],i),this.answerShown=!1,this.currentQuestionIndex=0,this.results=[],n.questionsInGameAmount=Math.min(t.length,n.questionsInGameAmount);const s=this.getWordsDataWithAnswers(t,n.answersInRoundAmount);this.wordsData=s,this.gameSettings=n;const o=new h(this.node,"div",["game-page__head-panel"]),r=new h(o.node,"div",["game-page__exit-buttons-wrapper"]);new h(r.node,"button",["game-page__back-btn"]).node.addEventListener("click",(()=>{this.onBack()}),{once:!0}),new h(r.node,"button",["game-page__home-btn"]).node.addEventListener("click",(()=>{this.onHome()}),{once:!0}),new h(o.node,"button",["game-page__fullscreen-btn"]).node.addEventListener("click",this.toggleFullScreen),this.mainField=new h(this.node,"div",["game-page__main-field","main-field"]),this.progressIndicatorsArr=[];const a=new h(this.mainField.node,"div",["main-field__progress-indicator-wrap","progress-indicator"]);for(let e=0;e<this.gameSettings.questionsInGameAmount;e++)this.progressIndicatorsArr.push(new h(a.node,"div",["progress-indicator__item"]));this.timer=new g(this.mainField.node,"div",["main-field__timer"]),this.questionCycle(),this.bindedWithThisKeyboardListener=this.keyboardListener.bind(this),window.addEventListener("keydown",this.bindedWithThisKeyboardListener)}getWordsDataWithAnswers(e,t){return e.map((n=>{const i=t=>{const n=e[m(0,e.length-1)].wordTranslate;return s.includes(n)||n===t?i(t):n},s=[],o=m(0,t-1),r=n.wordTranslate;for(let e=0;e<t;e++)o===e?s.push(r):s.push(i(r));return Object.assign(Object.assign({},n),{answers:s,correctAnswerIndex:o})}))}questionCycle(){this.questionView=new E(this.mainField.node,this.wordsData[this.currentQuestionIndex]),this.questionView.answersBtnArr.forEach(((e,t)=>{e.node.addEventListener("click",(()=>{this.onAnswer(t)}))})),this.seeAnswerButton=new h(this.mainField.node,"button",["common-btn","main-field__see-answer-btn"],"показать ответ"),this.seeAnswerButton.node.addEventListener("click",this.onSeeAnswerButton.bind(this)),this.gameSettings.timeEnable&&(this.bindedWithThisQuestionAudioEndedListener=this.questionAudioEndedListener.bind(this),this.questionView.questionAudio.addEventListener("ended",this.bindedWithThisQuestionAudioEndedListener,{once:!0}))}onAnswer(e,t=!0){var n;if(this.answerShown)return;this.timer.stop(),this.answerShown=!0;const i=this.wordsData[this.currentQuestionIndex],s=i.correctAnswerIndex,o=e===s;o?b.playSound(f.success):b.playSound(f.fail),null===(n=this.progressIndicatorsArr[this.currentQuestionIndex])||void 0===n||n.node.classList.add(o?"correct-answer":"incorrect-answer"),this.questionView.answersBtnArr[s].node.classList.add("correct-answer"),t&&!o&&this.questionView.answersBtnArr[e].node.classList.add("incorrect-answer"),this.questionView.questionAudioBtn.destroy(),new L(this.questionView.questionDataWrapper.node,i);const r={wordId:i.id,word:i.word,wordTranscription:i.transcription,wordTranslate:i.wordTranslate,wordAudioURL:i.audio,answerResult:o};this.results.push(r),this.seeAnswerButton.destroy(),this.nextQuestionButton=new h(this.mainField.node,"button",["common-btn","main-field__next-question-btn"],"следующий вопрос"),this.nextQuestionButton.node.addEventListener("click",this.onNextQuestionButton.bind(this))}onSeeAnswerButton(){this.onAnswer(null,!1)}onNextQuestionButton(){return S(this,void 0,void 0,(function*(){this.currentQuestionIndex+1>=this.gameSettings.questionsInGameAmount?this.onFinish(this.results):(this.currentQuestionIndex++,this.answerShown=!1,this.nextQuestionButton.destroy(),yield this.questionView.destroy(),this.questionCycle())}))}questionAudioEndedListener(){this.timer.start(this.gameSettings.time),this.timer.onTimeout=()=>{this.onAnswer(null,!1)}}keyboardListener(e){if(e.preventDefault(),!e.repeat)switch(e.code){case"Escape":this.onHome();break;case"Backspace":this.onBack();break;case"Space":this.questionView.questionAudioBtn.node.click();break;case"Digit1":this.questionView.answersBtnArr[0].node.click();break;case"Digit2":this.questionView.answersBtnArr[1].node.click();break;case"Digit3":this.questionView.answersBtnArr[2].node.click();break;case"Digit4":this.questionView.answersBtnArr[3].node.click();break;case"Digit5":this.questionView.answersBtnArr[4].node.click();break;case"Enter":this.answerShown?this.nextQuestionButton.node.click():this.seeAnswerButton.node.click();break;default:return}}destroy(){const e=Object.create(null,{destroy:{get:()=>super.destroy}});return S(this,void 0,void 0,(function*(){this.questionView.questionAudio.ended||this.questionView.questionAudio.removeEventListener("ended",this.bindedWithThisQuestionAudioEndedListener),window.removeEventListener("keydown",this.bindedWithThisKeyboardListener),this.timer.stop(),yield e.destroy.call(this)}))}}!function(e){e.AudioChallengeGameSettings="AudioChallengeGameSettings"}(C||(C={}));const q={levelAmount:6,questionsInGameAmount:20,answersInRoundAmount:5,time:10,timeEnable:!0};class F{constructor(){this.settings=q,this.loadFromStorage()}loadFromStorage(){const e=localStorage.getItem(C.AudioChallengeGameSettings);if(e){const t=JSON.parse(e);this.settings=t}else this.settings=q}getData(){return JSON.parse(JSON.stringify(this.settings))}setData(e){this.settings=e,this.saveToStorage()}saveToStorage(){localStorage.setItem(C.AudioChallengeGameSettings,JSON.stringify(this.settings))}}class I extends h{constructor(e,t){super(e,"div",["game-over-page__result-table","result-table"]);const n=t.filter((e=>!!e.answerResult)).length;new h(this.node,"div",["result-table__head-row"],`Верных ответов: ${n}`),t.forEach(this.renderTableRow.bind(this))}renderTableRow(e){const t=new h(this.node,"div",["result-table__row","table-row"]);new h(t.node,"button",["table-row__word-sound-btn"]).node.addEventListener("click",(()=>{b.playSound(`${A}/${e.wordAudioURL}`)})),new h(t.node,"span",["table-row__word"],`${e.word}`),new h(t.node,"span",["table-row__transcription"],`${e.wordTranscription}`),new h(t.node,"span",["table-row__translate"],`${e.wordTranslate}`);const n=new h(t.node,"span",["table-row__result-icon"],e.answerResult?"✔️":"❌");e.answerResult?n.node.classList.add("table-row__result-icon_correct"):n.node.classList.add("table-row__result-icon_incorrect")}}class $ extends p{constructor(e,t,n={hide:"hide",show:"show"}){super(e,"div",["game-over-page__container","game-over-page"],n);const i=new h(this.node,"div",["game-over-page__head-panel"]);new h(i.node,"button",["common-btn","game-over-page__fullscreen-btn"],"fullscreen").node.addEventListener("click",this.toggleFullScreen);const s=new h(this.node,"div",["game-over-page__main-field","main-field"]);new I(s.node,t);const o=new h(s.node,"div",["game-over-page__exit-buttons-wrapper"]);new h(o.node,"button",["game-over-page__next-btn"]).node.onclick=()=>{this.onNext()},new h(o.node,"button",["game-over-page__home-btn"]).node.onclick=()=>{this.onHome()}}}class B extends h{constructor(e,t="div",n=[],i=""){super(null,t,n,i),this.parentNode=e,this.isActivated=!1}activate(){this.isActivated||(this.parentNode.append(this.node),this.isActivated=!0)}deactivate(){this.isActivated&&(this.destroy(),this.isActivated=!1)}}var N,D,W=function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{d(i.next(e))}catch(e){o(e)}}function a(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}d((i=i.apply(e,t||[])).next())}))};class O extends h{constructor(e){super(e,"main",["audio-challenge-game","audio-challenge-game__container"]),this.preloader=new B(this.node,"div",["preloader"],"LOADING..."),this.preloader.activate(),this.settingsModel=new F,this.dataModel=new k,b.preload().then((()=>{this.categoriesCycle()}))}categoriesCycle(){const e=this.settingsModel.getData();this.preloader.deactivate();const t=new v(this.node,e);t.onHome=()=>W(this,void 0,void 0,(function*(){yield t.destroy(),console.log("to do onHome function")})),t.onSelect=e=>W(this,void 0,void 0,(function*(){yield t.destroy(),this.preloader.activate(),this.gameCycle(e)}))}gameCycle(e){return W(this,void 0,void 0,(function*(){const t=m(0,29),n=(yield this.dataModel.getWords(e,t)).sort((()=>m(-1,1))),i=this.settingsModel.getData();this.preloader.deactivate();const s=new T(this.node,n,i);s.onHome=()=>W(this,void 0,void 0,(function*(){yield s.destroy(),console.log("to do onHome function")})),s.onBack=()=>W(this,void 0,void 0,(function*(){yield s.destroy(),this.preloader.activate(),this.categoriesCycle()})),s.onFinish=e=>W(this,void 0,void 0,(function*(){b.playSound(f.applause),yield s.destroy();const t=new $(this.node,e);t.onHome=()=>W(this,void 0,void 0,(function*(){yield t.destroy(),console.log("to do onHome function")})),t.onNext=()=>W(this,void 0,void 0,(function*(){yield t.destroy(),this.preloader.activate(),this.categoriesCycle()}))}))}))}render(){return this.node}}!function(e){e[e.levelAmount=6]="levelAmount",e[e.time=60]="time",e[e.defaultNumberOfPointsForCorrectAnswer=20]="defaultNumberOfPointsForCorrectAnswer",e[e.increasingNumberOfPointsForCorrectAnswer=20]="increasingNumberOfPointsForCorrectAnswer",e[e.maximumNumberOfPointsForCorrectAnswer=80]="maximumNumberOfPointsForCorrectAnswer"}(N||(N={})),function(e){e.applause="../../assets/audio/applause.mp3",e.success="../../assets/audio/success.mp3",e.fail="../../assets/audio/fail.mp3"}(D||(D={}));class R extends p{constructor(e,t={hide:"hide",show:"show"}){super(e,"div",["categories-page","categories-page__container"],t);const n=new h(this.node,"div",["categories-page__head-panel"]);new h(n.node,"button",["categories-page__button_back"]).node.addEventListener("click",(()=>{this.onHome()}),{once:!0}),new h(n.node,"button",["categories-page__fullscreen-btn"]).node.addEventListener("click",this.toggleFullScreen);const i=new h(this.node,"div",["categories-page__main-field","main-field"]);new h(i.node,"h1",["game-name-title","main-field__game-name-title"],"Спринт"),new h(i.node,"div",["main-field__game-description-wrap","game-description"]).node.innerHTML='\n      <p class="game-description__description">\n        «Спринт» - это игра, для повторения выученных слов.\n        Каждый раунд вам нужно ответить, верно ли переведено слово из вопроса. Слова разделены на\n        категории по возрастанию сложности. Выберите категорию.\n      </p>\n      <ul class="game-description__instructions-list instructions-list">\n        <li class="instructions-list__item">\n          Используйте мышь, чтобы выбрать.\n        </li>\n        <li class="instructions-list__item">\n          Используйте клавиши влево или вправо\n        </li>\n      </ul>\n    ';const s=new h(i.node,"div",["main-field__categories-wrap","categories"]);for(let e=0;e<N.levelAmount;e++)new h(s.node,"button",["common-btn","categories__button"],`Level ${e+1}`).node.addEventListener("click",(()=>{this.onSelect(e)}))}}class P extends h{constructor(e,t){super(e,"div",["main-field__question-container","question-view"]),this.questionWord=new h(this.node,"span",["question-view__question-word"],`${t.word}`),this.questionTranslate=new h(this.node,"span",["question-view__question-translate"],`${t.likelyTranslate}`)}}class H extends p{constructor(e,t,n={hide:"hide",show:"show"}){super(e,"div",["game-page","game-page__container"],n),this.currentQuestionIndex=0,this.currentScore=0,this.results=[],this.correctAnswersCombinationData=[!1,!1,!1],this.pointsForCorrectAnswer=N.defaultNumberOfPointsForCorrectAnswer,this.wordsData=this.getWordsDataWithAnswers(t);const i=new h(this.node,"div",["game-page__head-panel"]),s=new h(i.node,"div",["game-page__exit-buttons-wrapper"]);new h(s.node,"button",["game-page__back-btn"]).node.addEventListener("click",(()=>{this.onBack()}),{once:!0}),new h(s.node,"button",["game-page__home-btn"]).node.addEventListener("click",(()=>{this.onHome()}),{once:!0}),new h(i.node,"button",["game-page__fullscreen-btn"]).node.addEventListener("click",this.toggleFullScreen),this.mainFieldWrapper=new h(this.node,"div",["game-page__main-field","main-field"]),this.timer=new g(this.mainFieldWrapper.node,"div",["main-field__timer"]),this.scoreIndicator=new h(this.mainFieldWrapper.node,"span",["main-field__score-indicator"],"Текущий результат: 0"),this.pointsForCorrectAnswerIndicator=new h(this.mainFieldWrapper.node,"div",["main-field__points-for-answer-indicator"],`Очков за слово +${this.pointsForCorrectAnswer}`),this.answersCombinationIndicatorsArr=[];const o=new h(this.mainFieldWrapper.node,"div",["main-field__answers-combination-indicator-wrap","answers-combination-indicator"]);for(let e=0;e<3;e++)this.answersCombinationIndicatorsArr.push(new h(o.node,"div",["answers-combination-indicator__item"]));this.questionArea=new h(this.mainFieldWrapper.node,"div",["main-field__question-area"]),this.questionCycle(),this.timer.start(N.time),this.timer.onTimeout=()=>{this.onFinish(this.results,this.currentScore)};const r=new h(this.mainFieldWrapper.node,"div",["main-field__answers-buttons-wrap"]);new h(r.node,"button",["common-btn","main-field__correct-answer-btn"],"верно").node.addEventListener("click",this.onAnswer.bind(this,!0)),new h(r.node,"button",["common-btn","main-field__incorrect-answer-btn"],"неверно").node.addEventListener("click",this.onAnswer.bind(this,!1)),this.bindedWithThisKeyboardListener=this.keyboardListener.bind(this),window.addEventListener("keydown",this.bindedWithThisKeyboardListener)}getWordsDataWithAnswers(e){return e.map((t=>{const n=t=>{const i=e[m(0,e.length-1)].wordTranslate;return i===t?n(t):i},i=t.wordTranslate,s=!!Math.round(Math.random());let o;return o=s?i:n(i),Object.assign(Object.assign({},t),{likelyTranslate:o,answer:s})}))}questionCycle(){this.questionView=new P(this.questionArea.node,this.wordsData[this.currentQuestionIndex])}onAnswer(e){const t=this.wordsData[this.currentQuestionIndex],n=e===t.answer;n?b.playSound(D.success):b.playSound(D.fail),n&&(this.currentScore+=this.pointsForCorrectAnswer,this.scoreIndicator.node.textContent=`Текущий результат: ${this.currentScore}`);const i={wordId:t.id,word:t.word,wordTranscription:t.transcription,wordTranslate:t.wordTranslate,wordAudioURL:t.audio,answerResult:n};this.results.push(i),this.uploadCorrectAnswersCombination(n),this.currentQuestionIndex++,this.questionView.destroy(),this.questionCycle()}uploadCorrectAnswersCombination(e){const t=()=>{this.answersCombinationIndicatorsArr.forEach(((e,t)=>{this.correctAnswersCombinationData[t]?e.node.classList.add("correct-answer"):e.node.classList.remove("correct-answer")}))};if(!e)return this.correctAnswersCombinationData=[!1,!1,!1],this.pointsForCorrectAnswer=N.defaultNumberOfPointsForCorrectAnswer,this.pointsForCorrectAnswerIndicator.node.textContent=`Очков за слово +${this.pointsForCorrectAnswer}`,void t();const n=this.correctAnswersCombinationData.indexOf(!1);-1===n?(this.correctAnswersCombinationData=[!1,!1,!1],this.pointsForCorrectAnswer<N.maximumNumberOfPointsForCorrectAnswer&&(this.pointsForCorrectAnswer+=N.increasingNumberOfPointsForCorrectAnswer),this.pointsForCorrectAnswerIndicator.node.textContent=`Очков за слово +${this.pointsForCorrectAnswer}`):this.correctAnswersCombinationData[n]=!0,t()}keyboardListener(e){if(e.preventDefault(),!e.repeat)switch(e.code){case"Escape":this.onHome();break;case"Backspace":this.onBack();break;case"ArrowRight":this.onAnswer.bind(this,!1);break;case"ArrowLeft":this.onAnswer.bind(this,!0);break;default:return}}destroy(){const e=Object.create(null,{destroy:{get:()=>super.destroy}});return t=this,n=void 0,s=function*(){window.removeEventListener("keydown",this.bindedWithThisKeyboardListener),this.timer.stop(),yield e.destroy.call(this)},new((i=void 0)||(i=Promise))((function(e,o){function r(e){try{d(s.next(e))}catch(e){o(e)}}function a(e){try{d(s.throw(e))}catch(e){o(e)}}function d(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(r,a)}d((s=s.apply(t,n||[])).next())}));var t,n,i,s}}class M extends h{constructor(e,t,n){super(e,"div",["game-over-page__result-table","result-table"]),new h(this.node,"div",["result-table__head-row"],`Очков набрано: ${n}`),t.forEach(this.renderTableRow.bind(this))}renderTableRow(e){const t=new h(this.node,"div",["result-table__row","table-row"]);new h(t.node,"button",["table-row__word-sound-btn"]).node.addEventListener("click",(()=>{b.playSound(`${A}/${e.wordAudioURL}`)})),new h(t.node,"span",["table-row__word"],`${e.word}`),new h(t.node,"span",["table-row__transcription"],`${e.wordTranscription}`),new h(t.node,"span",["table-row__translate"],`${e.wordTranslate}`);const n=new h(t.node,"span",["table-row__result-icon"],e.answerResult?"✔️":"❌");e.answerResult?n.node.classList.add("table-row__result-icon_correct"):n.node.classList.add("table-row__result-icon_incorrect")}}class V extends p{constructor(e,t,n,i={hide:"hide",show:"show"}){super(e,"div",["game-over-page__container","game-over-page"],i);const s=new h(this.node,"div",["game-over-page__head-panel"]);new h(s.node,"button",["common-btn","game-over-page__fullscreen-btn"]).node.addEventListener("click",this.toggleFullScreen);const o=new h(this.node,"div",["game-over-page__main-field","main-field"]);new M(o.node,t,n);const r=new h(o.node,"div",["game-over-page__exit-buttons-wrapper"]);new h(r.node,"button",["common-btn","game-over-page__next-btn"]).node.onclick=()=>{this.onNext()},new h(r.node,"button",["common-btn","game-over-page__home-btn"]).node.onclick=()=>{this.onHome()}}}var Q=function(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{d(i.next(e))}catch(e){o(e)}}function a(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}d((i=i.apply(e,t||[])).next())}))};class j extends h{constructor(e){super(e,"main",["sprint-game","sprint-game__container"]),this.preloader=new B(this.node,"div",["preloader"],"LOADING..."),this.preloader.activate(),this.dataModel=new k,b.preload().then((()=>{this.categoriesCycle()}))}categoriesCycle(){this.preloader.deactivate();const e=new R(this.node);e.onHome=()=>Q(this,void 0,void 0,(function*(){yield e.destroy(),console.log("to do onHome function")})),e.onSelect=t=>Q(this,void 0,void 0,(function*(){yield e.destroy(),this.preloader.activate(),this.gameCycle(t)}))}gameCycle(e){return Q(this,void 0,void 0,(function*(){const t=[];for(let n=0;n<10;n++)t.push(this.dataModel.getWords(e,m(0,29)));const n=(yield Promise.all(t)).flat().sort((()=>m(-1,1)));this.preloader.deactivate();const i=new H(this.node,n);i.onHome=()=>Q(this,void 0,void 0,(function*(){yield i.destroy(),console.log("to do onHome function")})),i.onBack=()=>Q(this,void 0,void 0,(function*(){yield i.destroy(),this.preloader.activate(),this.categoriesCycle()})),i.onFinish=(e,t)=>Q(this,void 0,void 0,(function*(){b.playSound(D.applause),yield i.destroy();const n=new V(this.node,e,t);n.onHome=()=>Q(this,void 0,void 0,(function*(){yield n.destroy(),console.log("to do onHome function")})),n.onNext=()=>Q(this,void 0,void 0,(function*(){yield n.destroy(),this.preloader.activate(),this.categoriesCycle()}))}))}))}render(){return this.node}}class G{constructor(t){this.rootElement=t,this.mainPage=new e(this.rootElement);const n=new u(this.rootElement);this.routes=[{name:"",component:()=>{this.rootElement.append(null==n?void 0:n.element)}},{name:"auth",component:()=>{const e=new d(this.rootElement);this.rootElement.append(null==n?void 0:n.element),this.rootElement.append(e.element)}},{name:"audio-challenge",component:()=>{new O(this.rootElement)}},{name:"sprint",component:()=>{new j(this.rootElement)}}],this.defaultRoute={name:"Default router",component:()=>{this.rootElement.append(null==n?void 0:n.element)}}}updateRouter(){this.rootElement.innerHTML="";const e=window.location.hash.slice(1);(this.routes.find((t=>t.name===e))||this.defaultRoute).component()}initRouter(){window.onpopstate=()=>this.updateRouter(),this.updateRouter()}}class z{constructor(t){this.rootElement=t,this.main=new e(this.rootElement,"main",["main"]),this.router=new G(this.main.element)}init(){this.router.initRouter()}}window.addEventListener("DOMContentLoaded",(()=>{const e=document.body;new z(e).init()}))})();